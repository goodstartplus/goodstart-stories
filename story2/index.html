<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story</title>
    <link rel="stylesheet" href="/assets/style.css">
</head>
<body>
    <div class="progress-container" id="progressContainer"></div>
    <div class="carousel" id="carousel">
        <div class="story"><img src="imagem1.jpg" alt="Imagem Story 1"></div>
        <div class="story"><video src="video1.mp4" controls></video></div>
    </div>
    <script>
        const slides = document.querySelectorAll('.story');
        const progressContainer = document.getElementById('progressContainer');
        let currentSlide = 0;

        function createProgressBars() {
            progressContainer.innerHTML = '';
            slides.forEach((_, index) => {
                const bar = document.createElement('div');
                bar.classList.add('progress-bar');
                if (index === 0) bar.classList.add('active');
                progressContainer.appendChild(bar);
            });
        }

        function updateProgressBar() {
            const bars = document.querySelectorAll('.progress-bar');
            bars.forEach((bar, index) => {
                bar.classList.toggle('active', index === currentSlide);
            });
        }

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.style.display = i === index ? 'block' : 'none';
                if (slide.querySelector('video')) {
                    const video = slide.querySelector('video');
                    video.pause();
                    video.currentTime = 0;
                    if (i === index) video.play();
                }
            });
            updateProgressBar();
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + slides.length) % slides.length;
            showSlide(currentSlide);
        }

        function nextStory() {
            const nextStoryLink = {
                '/story1/': '/story2/',
                '/story2/': '/story3/',
                '/story3/': '/story1/'
            }[window.location.pathname];
            window.location.href = nextStoryLink;
        }

        function prevStory() {
            const prevStoryLink = {
                '/story1/': '/story3/',
                '/story2/': '/story1/',
                '/story3/': '/story2/'
            }[window.location.pathname];
            window.location.href = prevStoryLink;
        }

        document.addEventListener('click', (e) => {
            const clickX = e.clientX;
            const screenWidth = window.innerWidth;
            if (clickX < screenWidth / 2) {
                prevSlide();
            } else {
                nextSlide();
            }
        });

        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeDistance = touchEndX - touchStartX;
            if (swipeDistance > 100) {
                prevStory();
            } else if (swipeDistance < -100) {
                nextStory();
            }
        }

        createProgressBars();
        showSlide(currentSlide);
    </script>
</body>
</html>
